<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Traductor Universal Automático</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 900px;
            width: 100%;
            background: rgba(255, 255, 255, 0.97);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(to right, #2c5364, #203a43, #0f2027);
            color: white;
            padding: 25px;
            text-align: center;
            position: relative;
        }
        
        .language-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
        }
        
        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .main-content {
            display: flex;
            padding: 30px;
            gap: 30px;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
        }
        
        .input-section, .output-section {
            flex: 1;
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            position: relative;
        }
        
        .section-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
            color: #2c5364;
        }
        
        .language-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        select {
            flex: 1;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s ease;
            background-color: white;
            cursor: pointer;
        }
        
        select:focus {
            border-color: #2c5364;
            box-shadow: 0 0 0 3px rgba(44, 83, 100, 0.2);
        }
        
        textarea {
            width: 100%;
            height: 150px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1.1rem;
            resize: vertical;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }
        
        textarea:focus {
            border-color: #2c5364;
            box-shadow: 0 0 0 3px rgba(44, 83, 100, 0.2);
            outline: none;
        }
        
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 20px;
        }
        
        button {
            flex: 1;
            min-width: 120px;
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .record-btn {
            background: linear-gradient(to right, #4CAF50, #2E7D32);
            color: white;
            min-width: auto;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            padding: 0;
            position: relative;
        }
        
        .record-btn.recording {
            animation: pulse 1.5s infinite;
        }
        
        .voice-translate-btn {
            background: linear-gradient(to right, #2196F3, #1565C0);
            color: white;
            min-width: auto;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            padding: 0;
        }
        
        .play-btn {
            background: linear-gradient(to right, #2196F3, #1565C0);
            color: white;
        }
        
        .detected-language {
            background: #e3f2fd;
            padding: 12px;
            border-radius: 10px;
            margin-top: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.95rem;
        }
        
        .pulse {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { 
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.7);
            }
            70% { 
                transform: scale(1.05);
                box-shadow: 0 0 0 10px rgba(76, 175, 80, 0);
            }
            100% { 
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(76, 175, 80, 0);
            }
        }
        
        .recording-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 15px;
            color: #f44336;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .recording-dot {
            width: 10px;
            height: 10px;
            background: #f44336;
            border-radius: 50%;
            animation: blink 1.5s infinite;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: white;
            background: linear-gradient(to right, #2c5364, #203a43, #0f2027);
            font-size: 0.9rem;
        }
        
        .feature-list {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
            justify-content: center;
        }
        
        .feature {
            background: rgba(44, 83, 100, 0.7);
            padding: 15px;
            border-radius: 10px;
            width: 200px;
            text-align: center;
            transition: transform 0.3s ease;
            color: white;
        }
        
        .feature:hover {
            transform: translateY(-5px);
            background: rgba(32, 58, 67, 0.7);
        }
        
        .feature i {
            font-size: 2rem;
            margin-bottom: 10px;
            color: white;
        }
        
        .mic-container {
            display: flex;
            justify-content: center;
            margin-top: 10px;
            gap: 10px;
        }
        
        .translation-status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            display: none;
        }
        
        .translating {
            background-color: #e3f2fd;
            color: #2c5364;
        }
        
        .translated {
            background-color: #e8f5e9;
            color: #2E7D32;
        }
        
        .error {
            background-color: #ffebee;
            color: #c62828;
        }
        
        .char-count {
            text-align: right;
            font-size: 0.8rem;
            color: #666;
            margin-top: -15px;
            margin-bottom: 10px;
        }
        
        .auto-translate-label {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            font-size: 0.9rem;
            color: #2c5364;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #4CAF50;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .voice-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="language-badge">Traducción automática</div>
            <h1><i class="fas fa-language"></i> Traductor Universal</h1>
            <p>Traduce en tiempo real mientras escribes o hablas</p>
        </header>
        
        <div class="main-content">
            <div class="input-section">
                <div class="section-title">
                    <i class="fas fa-keyboard"></i>
                    <h2>Texto de Entrada</h2>
                </div>
                
                <div class="language-selector">
                    <select id="source-lang">
                        <option value="auto">Autodetección de idioma</option>
                        <option value="es">Español</option>
                        <option value="en">Inglés</option>
                        <option value="fr">Francés</option>
                        <option value="de">Alemán</option>
                        <option value="it">Italiano</option>
                        <option value="pt">Portugués</option>
                        <option value="ja">Japonés</option>
                        <option value="zh">Chino</option>
                    </select>
                </div>
                
                <textarea id="input-text" placeholder="Escribe o habla aquí..."></textarea>
                <div class="char-count"><span id="char-count">0</span>/500 caracteres</div>
                
                <div class="detected-language">
                    <i class="fas fa-globe-americas"></i>
                    <span>Idioma detectado: <span id="detected-lang">Español</span></span>
                </div>
                
                <div class="voice-controls">
                    <div class="mic-container">
                        <button class="record-btn" id="record-btn" title="Comenzar grabación">
                            <i class="fas fa-microphone"></i>
                        </button>
                        <button class="voice-translate-btn" id="voice-translate-btn" title="Traducir por voz">
                            <i class="fas fa-robot"></i>
                        </button>
                    </div>
                </div>
                
                <div id="recording-indicator" class="recording-indicator" style="display: none;">
                    <div class="recording-dot"></div>
                    <span>Grabando audio... Habla ahora</span>
                </div>
            </div>
            
            <div class="output-section">
                <div class="section-title">
                    <i class="fas fa-exchange-alt"></i>
                    <h2>Traducción</h2>
                </div>
                
                <div class="language-selector">
                    <select id="target-lang">
                        <option value="en">Inglés</option>
                        <option value="es">Español</option>
                        <option value="fr">Francés</option>
                        <option value="de">Alemán</option>
                        <option value="it">Italiano</option>
                        <option value="pt">Portugués</option>
                        <option value="ja">Japonés</option>
                        <option value="zh">Chino</option>
                    </select>
                </div>
                
                <textarea id="output-text" placeholder="La traducción aparecerá automáticamente..." readonly></textarea>
                <div id="translation-status" class="translation-status"></div>
                
                <div class="controls">
                    <button class="play-btn" id="play-output-btn">
                        <i class="fas fa-volume-up"></i> Escuchar Traducción
                    </button>
                </div>
                
                <div class="auto-translate-label">
                    <i class="fas fa-bolt"></i>
                    <span>Traducción automática activada</span>
                </div>
            </div>
        </div>
        
        <div class="feature-list">
            <div class="feature">
                <i class="fas fa-microphone-alt"></i>
                <h3>Reconocimiento de Voz</h3>
                <p>Habla y se transcribirá automáticamente</p>
            </div>
            <div class="feature">
                <i class="fas fa-robot"></i>
                <h3>Traducción en Tiempo Real</h3>
                <p>Resultados instantáneos mientras hablas</p>
            </div>
            <div class="feature">
                <i class="fas fa-bolt"></i>
                <h3>Traducción Automática</h3>
                <p>Sin necesidad de presionar botones</p>
            </div>
        </div>
        
        <footer>
            <p>Traductor Universal &copy; 2023 - Tecnología de traducción avanzada</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Elementos del DOM
            const recordBtn = document.getElementById('record-btn');
            const voiceTranslateBtn = document.getElementById('voice-translate-btn');
            const playInputBtn = document.getElementById('play-input-btn');
            const playOutputBtn = document.getElementById('play-output-btn');
            const inputText = document.getElementById('input-text');
            const outputText = document.getElementById('output-text');
            const sourceLang = document.getElementById('source-lang');
            const targetLang = document.getElementById('target-lang');
            const detectedLang = document.getElementById('detected-lang');
            const recordingIndicator = document.getElementById('recording-indicator');
            const charCount = document.getElementById('char-count');
            const translationStatus = document.getElementById('translation-status');
            
            // Variables de estado
            let recognition;
            let isRecording = false;
            let translateTimeout;
            let lastTranslatedText = '';
            
            // Idiomas soportados
            const languages = {
                'auto': 'Autodetección',
                'en': 'Inglés',
                'es': 'Español',
                'fr': 'Francés',
                'de': 'Alemán',
                'it': 'Italiano',
                'pt': 'Portugués',
                'ja': 'Japonés',
                'zh': 'Chino',
                'ru': 'Ruso',
                'ar': 'Árabe',
                'hi': 'Hindi'
            };
            
            // Actualizar contador de caracteres
            inputText.addEventListener('input', function() {
                charCount.textContent = inputText.value.length;
                if (inputText.value.length > 500) {
                    charCount.style.color = '#f44336';
                } else {
                    charCount.style.color = '#666';
                }
                
                // Traducir automáticamente con un pequeño retardo
                clearTimeout(translateTimeout);
                translateTimeout = setTimeout(translateText, 500);
            });
            
            // Inicializar reconocimiento de voz si está disponible
            if ('SpeechRecognition' in window || 'webkitSpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                recognition = new SpeechRecognition();
                recognition.continuous = true;
                recognition.interimResults = true;
                recognition.lang = 'es-ES';
                
                recognition.onresult = function(event) {
                    let transcript = '';
                    for (let i = event.resultIndex; i < event.results.length; i++) {
                        transcript += event.results[i][0].transcript;
                    }
                    inputText.value = transcript;
                    charCount.textContent = transcript.length;
                    
                    // Traducir automáticamente
                    translateText();
                };
                
                recognition.onerror = function(event) {
                    console.error('Error en reconocimiento de voz:', event.error);
                    stopRecording();
                    alert('Error en reconocimiento de voz: ' + event.error);
                };
                
                recognition.onend = function() {
                    if (isRecording) {
                        recognition.start();
                    }
                };
            } else {
                recordBtn.disabled = true;
                recordBtn.innerHTML = '<i class="fas fa-microphone-slash"></i>';
                recordBtn.title = 'Navegador no compatible';
                voiceTranslateBtn.disabled = true;
                voiceTranslateBtn.innerHTML = '<i class="fas fa-ban"></i>';
                voiceTranslateBtn.title = 'Navegador no compatible';
                alert('Tu navegador no soporta reconocimiento de voz. Prueba con Chrome o Edge.');
            }
            
            // Event Listeners
            recordBtn.addEventListener('click', toggleRecording);
            voiceTranslateBtn.addEventListener('click', startVoiceTranslation);
            playOutputBtn.addEventListener('click', () => speakText(outputText.value, targetLang.value));
            sourceLang.addEventListener('change', updateDetectedLang);
            targetLang.addEventListener('change', translateText);
            
            // Funciones principales
            function toggleRecording() {
                if (!isRecording) {
                    startRecording();
                } else {
                    stopRecording();
                }
            }
            
            function startRecording() {
                if (recognition) {
                    recognition.start();
                    isRecording = true;
                    recordBtn.classList.add('recording');
                    recordBtn.innerHTML = '<i class="fas fa-square"></i>';
                    recordBtn.title = 'Detener grabación';
                    recordingIndicator.style.display = 'flex';
                    
                    // Actualizar idioma de reconocimiento
                    if (sourceLang.value !== 'auto') {
                        recognition.lang = sourceLang.value + '-' + sourceLang.value.toUpperCase();
                    }
                }
            }
            
            function stopRecording() {
                if (recognition) {
                    recognition.stop();
                    isRecording = false;
                    recordBtn.classList.remove('recording');
                    recordBtn.innerHTML = '<i class="fas fa-microphone"></i>';
                    recordBtn.title = 'Comenzar grabación';
                    recordingIndicator.style.display = 'none';
                }
            }
            
            function startVoiceTranslation() {
                if (recognition) {
                    // Configurar para traducción directa a idioma destino
                    recognition.stop();
                    
                    // Establecer el idioma de destino para el reconocimiento
                    recognition.lang = targetLang.value + '-' + targetLang.value.toUpperCase();
                    
                    recognition.start();
                    isRecording = true;
                    voiceTranslateBtn.classList.add('recording');
                    voiceTranslateBtn.innerHTML = '<i class="fas fa-square"></i>';
                    voiceTranslateBtn.title = 'Detener traducción';
                    recordingIndicator.style.display = 'flex';
                    recordingIndicator.innerHTML = `
                        <div class="recording-dot"></div>
                        <span>Habla en <strong>${languages[targetLang.value]}</strong> para traducir a texto</span>
                    `;
                    
                    // Limpiar el texto de entrada
                    inputText.value = '';
                    
                    recognition.onresult = function(event) {
                        let transcript = '';
                        for (let i = event.resultIndex; i < event.results.length; i++) {
                            transcript += event.results[i][0].transcript;
                        }
                        
                        // Colocar el texto traducido directamente en el output
                        outputText.value = transcript;
                        
                        // Actualizar estado
                        translationStatus.textContent = "Traducción por voz completada";
                        translationStatus.className = "translation-status translated";
                        translationStatus.style.display = "block";
                        
                        setTimeout(() => {
                            translationStatus.style.display = "none";
                        }, 3000);
                    };
                }
            }
            
            // Función para traducir usando Google Translate API
            function translateText() {
                const text = inputText.value.trim();
                
                if (text === '' || text === lastTranslatedText) {
                    outputText.value = '';
                    translationStatus.style.display = 'none';
                    return;
                }
                
                lastTranslatedText = text;
                
                // Actualizar idioma detectado
                updateDetectedLang();
                
                // Mostrar estado de traducción
                translationStatus.textContent = "Traduciendo...";
                translationStatus.className = "translation-status translating";
                translationStatus.style.display = "block";
                
                const source = sourceLang.value === 'auto' ? 'auto' : sourceLang.value;
                const target = targetLang.value;
                
                // Usar la API de Google Translate
                const apiUrl = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=${source}&tl=${target}&dt=t&q=${encodeURIComponent(text)}`;
                
                fetch(apiUrl)
                    .then(response => response.json())
                    .then(data => {
                        // Extraer el texto traducido
                        let translatedText = '';
                        data[0].forEach(item => {
                            translatedText += item[0];
                        });
                        
                        outputText.value = translatedText;
                        translationStatus.textContent = "Traducción completada automáticamente";
                        translationStatus.className = "translation-status translated";
                        
                        // Ocultar el estado después de 3 segundos
                        setTimeout(() => {
                            translationStatus.style.display = "none";
                        }, 3000);
                    })
                    .catch(error => {
                        console.error('Error en traducción:', error);
                        outputText.value = "Error en la traducción. Inténtalo de nuevo.";
                        translationStatus.textContent = "Error en la traducción";
                        translationStatus.className = "translation-status error";
                    });
            }
            
            function speakText(text, lang) {
                if ('speechSynthesis' in window) {
                    if (text.trim() === '') return;
                    
                    const utterance = new SpeechSynthesisUtterance(text);
                    
                    // Establecer idioma
                    if (lang && lang !== 'auto') {
                        utterance.lang = lang + '-' + lang.toUpperCase();
                    }
                    
                    utterance.rate = 1.0;
                    utterance.pitch = 1.0;
                    utterance.volume = 1.0;
                    
                    window.speechSynthesis.cancel();
                    window.speechSynthesis.speak(utterance);
                } else {
                    alert('Tu navegador no soporta síntesis de voz.');
                }
            }
            
            function updateDetectedLang() {
                if (sourceLang.value === 'auto') {
                    // En una implementación real, esto detectaría el idioma
                    detectedLang.textContent = "Español";
                } else {
                    detectedLang.textContent = languages[sourceLang.value];
                }
                
                // Traducir automáticamente al cambiar idioma
                translateText();
            }
        });
    </script>
</body>
</html>
